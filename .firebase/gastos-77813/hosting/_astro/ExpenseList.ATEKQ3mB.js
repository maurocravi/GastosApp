import{i as kt}from"./index.CAEKJqJT.js";import{e as Ft,o as Nt}from"./expenseStore.D1yuVpDE.js";import{s as l,f as x,a as v,p as Ct,b as At,m as f,c as r,d,g as e,r as a,t as O,e as Tt,h as $t,i as Mt}from"./template.BYwTzaMl.js";import{s as y,e as Y}from"./render._rOquw-i.js";import{i as j,s as J}from"./Notification.Bt18E80j.js";import{e as B,r as V,i as Ot,b as W,a as St}from"./input.b8hoI3La.js";import{d as rt,a as ot,u as Gt,T as zt,b as Lt}from"./firebase.DbQp2EyT.js";var Rt=x('<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td></tr>'),Ut=x('<div class="overflow-x-auto shadow-md sm:rounded-lg"><table class="min-w-full bg-white"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Año</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Yt=x("<p>No hay resumen anual disponible.</p>"),jt=x('<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td></tr>'),Jt=x('<div class="overflow-x-auto shadow-md sm:rounded-lg"><table class="min-w-full bg-white"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mes</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Bt=x("<p>No hay resumen mensual disponible.</p>"),Ht=x("<option> </option>"),It=x('<tr><td class="px-6 py-4 whitespace-nowrap"><input type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"/></td><td class="px-6 py-4 whitespace-nowrap"><select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></select></td><td class="px-6 py-4 whitespace-nowrap"><input type="number" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"/></td><td class="px-6 py-4 whitespace-nowrap"><input type="date" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"/></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><button class="text-green-600 hover:text-green-900 mr-3  transition-all duration-300 ease-in-out cursor-pointer">Guardar</button> <button class="text-gray-600 hover:text-gray-900 transition-all duration-300 ease-in-out cursor-pointer">Cancelar</button></td></tr>'),Kt=x('<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><button class="text-indigo-600 hover:text-indigo-900 mr-3 transition-all duration-300 ease-in-out cursor-pointer">Editar</button> <button class="text-red-600 hover:text-red-900 transition-all duration-300 ease-in-out cursor-pointer">Eliminar</button></td></tr>'),Pt=x('<div class="overflow-x-auto shadow-md sm:rounded-lg"><table class="min-w-full bg-white"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripción</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoría</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cantidad</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Zt=x("<p>No hay gastos registrados aún.</p>"),qt=x('<div class="container mx-auto p-4"><div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"><div><h2 class="text-2xl font-bold mb-4">Resumen Anual</h2> <!></div> <div><h2 class="text-2xl font-bold mb-4">Resumen Mensual</h2> <!></div></div> <div class="mb-8"><h2 class="text-2xl font-bold mb-4">Lista de Gastos</h2> <!></div></div>');function ra(st,it){At(it,!1);let H=f([]),k=f(null),S=f(""),G=f(""),z=f(""),F=f("");const nt=["Ocio","Comida/Bebida","Hogar","Gastos Personales","Otros"];let I=f({}),K=f({});const dt=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],ct=t=>{const o={},c={};t.forEach(s=>{const i=new Date(s.fecha),n=i.getUTCFullYear(),p=i.getUTCMonth(),u=`${n}-${p}`;o[u]||(o[u]={year:n,month:p,total:0}),o[u].total+=s.cantidad,c[n]||(c[n]={year:n,total:0}),c[n].total+=s.cantidad}),l(I,Object.values(o).sort((s,i)=>i.year-s.year||i.month-s.month).map(s=>({...s,monthName:dt[s.month]}))),l(K,Object.values(c).sort((s,i)=>i.year-s.year))},X=Ft.subscribe(({data:t})=>{l(H,t),ct(t)});Nt(()=>{X&&X()});function lt(t){const o=new Date(t),c=o.getFullYear(),s=("0"+(o.getMonth()+1)).slice(-2),i=("0"+o.getDate()).slice(-2);return`${c}-${s}-${i}`}const pt=async t=>{try{await Lt(rt(ot,"gastos",t)),J("Gasto eliminado correctamente","success")}catch(o){console.error("Error removing document: ",o),J("Error al eliminar el gasto","error")}},ut=t=>{l(k,t),l(S,t.descripcion),l(G,t.cantidad),l(z,lt(t.fecha)),l(F,t.categoria||"Otros")},vt=()=>{l(k,null)},xt=async()=>{try{const t=rt(ot,"gastos",e(k).id);await Gt(t,{descripcion:e(S),cantidad:parseFloat(e(G)),fecha:zt.fromDate(new Date(e(z))),categoria:e(F)}),l(k,null),J("Gasto actualizado correctamente","success")}catch(t){console.error("Error updating document: ",t),J("Error al actualizar el gasto","error")}};kt();var P=qt(),Z=r(P),q=r(Z),mt=d(r(q),2);{var ht=t=>{var o=Ut(),c=r(o),s=d(r(c));B(s,5,()=>e(K),i=>i.year,(i,n)=>{var p=Rt(),u=r(p),N=r(u,!0);a(u);var b=d(u),g=r(b);a(b),a(p),O(m=>{y(N,e(n).year),y(g,`$${m??""}`)},[()=>e(n).total.toFixed(2)]),v(i,p)}),a(s),a(c),a(o),v(t,o)},gt=t=>{var o=Yt();v(t,o)};j(mt,t=>{e(K).length>0?t(ht):t(gt,!1)})}a(q);var tt=d(q,2),yt=d(r(tt),2);{var ft=t=>{var o=Jt(),c=r(o),s=d(r(c));B(s,5,()=>e(I),i=>`${i.year}-${i.month}`,(i,n)=>{var p=jt(),u=r(p),N=r(u);a(u);var b=d(u),g=r(b);a(b),a(p),O(m=>{y(N,`${e(n).monthName??""} ${e(n).year??""}`),y(g,`$${m??""}`)},[()=>e(n).total.toFixed(2)]),v(i,p)}),a(s),a(c),a(o),v(t,o)},bt=t=>{var o=Bt();v(t,o)};j(yt,t=>{e(I).length>0?t(ft):t(bt,!1)})}a(tt),a(Z);var at=d(Z,2),_t=d(r(at),2);{var wt=t=>{var o=Pt(),c=r(o),s=d(r(c));B(s,5,()=>e(H),i=>i.id,(i,n)=>{var p=Tt(),u=$t(p);{var N=g=>{var m=It(),_=r(m),L=r(_);V(L),a(_);var w=d(_),C=r(w);O(()=>{e(F),Mt(()=>{})}),B(C,5,()=>nt,Ot,(h,$)=>{var M=Ht(),Et=r(M,!0);a(M);var et={};O(()=>{y(Et,e($)),et!==(et=e($))&&(M.value=(M.__value=e($))??"")}),v(h,M)}),a(C),a(w);var D=d(w),R=r(D);V(R),a(D);var E=d(D),U=r(E);V(U),a(E);var A=d(E),T=r(A),Q=d(T,2);a(A),a(m),W(L,()=>e(S),h=>l(S,h)),St(C,()=>e(F),h=>l(F,h)),W(R,()=>e(G),h=>l(G,h)),W(U,()=>e(z),h=>l(z,h)),Y("click",T,xt),Y("click",Q,vt),v(g,m)},b=g=>{var m=Kt(),_=r(m),L=r(_,!0);a(_);var w=d(_),C=r(w,!0);a(w);var D=d(w),R=r(D);a(D);var E=d(D),U=r(E,!0);a(E);var A=d(E),T=r(A),Q=d(T,2);a(A),a(m),O((h,$)=>{y(L,e(n).descripcion),y(C,e(n).categoria||"N/A"),y(R,`$${h??""}`),y(U,$)},[()=>e(n).cantidad.toFixed(2),()=>e(n).fecha.toLocaleDateString("es-ES",{timeZone:"UTC"})]),Y("click",T,()=>ut(e(n))),Y("click",Q,()=>pt(e(n).id)),v(g,m)};j(u,g=>{e(k)&&e(k).id===e(n).id?g(N):g(b,!1)})}v(i,p)}),a(s),a(c),a(o),v(t,o)},Dt=t=>{var o=Zt();v(t,o)};j(_t,t=>{e(H).length>0?t(wt):t(Dt,!1)})}a(at),a(P),v(st,P),Ct()}export{ra as default};
