import{i as Vt}from"./index.xVMkLsqj.js";import{k as _e,B as he,C as we,P as De,g as a,D as Ee,A as Pe,d as f,E as Ce,F as Se,j as Oe,G as ke,H as Ae,I as Me,S as $e,L as Ne,J as vt,K as tt,a as g,p as Wt,b as Xt,f as h,c as r,s,r as t,t as G,M as Te,N as Fe,m as B,n as v,i as Re}from"./template.DDEeykWN.js";import{s as P,e as O}from"./render.B6CLu_wd.js";import{c as ze,i as Q,t as Ie,f as Le,a as je,b as Ut,s as ct}from"./Notification.CAJLCjiD.js";import{s as Be,e as ut,r as wt,i as Ge,b as Dt,a as Ye}from"./event-modifiers.BW9v4m8z.js";import{c as Ue,p as qt,a as Et,b as Jt,n as Ht}from"./expenseStore.CKZln5LS.js";import{e as qe,f as Kt,d as Zt,u as Je,T as He}from"./firebase.DqkX-9P5.js";function Ke(x,b){var D=x.$$events?.[b.type],R=_e(D)?D.slice():D==null?[]:[D];for(var c of R)c.call(this,b)}function Qt(x,b,D,R){var c=!Oe||(D&ke)!==0,i=(D&Ae)!==0,p=R,k=!0,z=()=>(k&&(k=!1,p=R),p),C;{var A=$e in x||Ne in x;C=he(x,b)?.set??(A&&b in x?u=>x[b]=u:void 0)}var y,E=!1;[y,E]=ze(()=>x[b]),y===void 0&&R!==void 0&&(y=z(),C&&(c&&we(),C(y)));var M;if(c?M=()=>{var u=x[b];return u===void 0?z():(k=!0,u)}:M=()=>{var u=x[b];return u!==void 0&&(p=void 0),u===void 0?p:u},c&&(D&De)===0)return M;if(C){var T=x.$$legacy;return function(u,L){return arguments.length>0?((!c||!L||T||E)&&C(L?M():u),u):M()}}var $=!1,I=Ee(()=>($=!1,M()));a(I);var V=Ce;return function(u,L){if(arguments.length>0){const W=L?a(I):c&&i?Pe(u):u;return f(I,W),$=!0,p!==void 0&&(p=W),u}return Me&&$||(V.f&Se)!==0?I.v:a(I)}}var Ze=h('<div class="fixed inset-0 bg-gray-100/90 overflow-y-auto h-full w-full z-50 flex items-center justify-center"><div class="relative mx-auto p-6 border w-full max-w-md shadow-lg rounded-md bg-white"><div class="mt-3 text-center"><h3 class="text-xl leading-6 font-medium text-gray-900">Confirmación</h3> <div class="mt-4 mb-6"><p class="text-base text-gray-600"> </p></div> <div class="flex justify-center space-x-4"><button class="px-6 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 transition-all duration-200">Cancelar</button> <button class="px-6 py-2 bg-red-600 text-white font-semibold rounded-lg shadow-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition-all duration-200">Eliminar</button></div></div></div></div>');function Qe(x,b){Xt(b,!1);let D=Qt(b,"isOpen",8,!1),R=Qt(b,"message",8,"¿Estás seguro?");const c=Ue();function i(){c("confirm")}function p(){c("cancel")}Vt();var k=vt(),z=tt(k);{var C=A=>{var y=Ze(),E=r(y),M=r(E),T=s(r(M),2),$=r(T),I=r($,!0);t($),t(T);var V=s(T,2),u=r(V),L=s(u,2);t(V),t(M),t(E),t(y),G(()=>P(I,R())),O("click",u,p),O("click",L,i),Ie(3,E,()=>Le,()=>({y:-50,duration:300})),O("click",E,Be(function(W){Ke.call(this,b,W)})),O("click",y,p),g(A,y)};Q(z,A=>{D()&&A(C)})}g(x,k),Wt()}var Ve=h('<tr class="bg-white "><td class="px-6 py-4 font-medium text-gray-900"> </td><td class="px-6 py-4 text-gray-500"> </td></tr>'),We=h('<div class="overflow-x-auto"><table class="min-w-full text-sm text-left text-gray-700"><thead class="bg-gray-50 text-xs text-gray-500 uppercase"><tr><th scope="col" class="px-6 py-3">Año</th><th scope="col" class="px-6 py-3">Total</th></tr></thead><tbody></tbody></table></div>'),Xe=h('<p class="p-6 text-center text-gray-500">No hay datos para el resumen anual.</p>'),ta=h('<tr class="bg-white"><td class="px-6 py-4 font-medium text-gray-900"> </td><td class="px-6 py-4 text-gray-500"> </td></tr>'),ea=h('<div class="overflow-x-auto max-h-80"><table class="min-w-full text-sm text-left text-gray-700"><thead class="bg-gray-50 text-xs text-gray-500 uppercase sticky top-0"><tr><th scope="col" class="px-6 py-3">Mes</th><th scope="col" class="px-6 py-3">Total</th></tr></thead><tbody class="overflow-y-auto"></tbody></table></div>'),aa=h('<p class="p-6 text-center text-gray-500">No hay datos para el resumen mensual.</p>'),ra=h('<p class="px-6 py-10 text-center text-gray-500">Cargando gastos...</p>'),sa=h('<p class="px-6 py-10 text-center text-red-500"> </p>'),oa=h("<option> </option>"),ia=h('<tr class="bg-blue-50 border-b"><td class="px-6 py-4"><input type="text" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"/></td><td class="px-6 py-4"><select class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"></select></td><td class="px-6 py-4"><input type="number" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"/></td><td class="px-6 py-4"><input type="date" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"/></td><td class="px-6 py-4 text-right"><button class="font-medium text-green-600 hover:text-green-800 mr-4 transition-all duration-300 ease-in-out cursor-pointer">Guardar</button> <button class="font-medium text-gray-600 hover:text-gray-800 transition-all duration-300 ease-in-out cursor-pointer">Cancelar</button></td></tr>'),na=h('<tr class="bg-white border-b border-gray-100 hover:bg-gray-50"><td class="px-6 py-4 font-medium text-gray-900"> </td><td class="px-6 py-4 text-gray-500"> </td><td class="px-6 py-4 text-gray-500"> </td><td class="px-6 py-4 text-gray-500"> </td><td class="px-6 py-4 text-right"><button class="font-medium text-indigo-600 hover:text-indigo-900 mr-4 transition-all duration-300 ease-in-out cursor-pointer">Editar</button> <button class="font-medium text-red-600 hover:text-red-900 transition-all duration-300 ease-in-out cursor-pointer">Eliminar</button></td></tr>'),la=h('<div class="overflow-x-auto"><table class="min-w-full text-sm text-left text-gray-700"><thead class="bg-gray-50 text-xs text-gray-500 uppercase"><tr><th scope="col" class="px-6 py-3">Descripción</th><th scope="col" class="px-6 py-3">Categoría</th><th scope="col" class="px-6 py-3">Cantidad</th><th scope="col" class="px-6 py-3">Fecha</th><th scope="col" class="px-6 py-3 text-right">Acciones</th></tr></thead><tbody></tbody></table></div> <div class="flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6"><div class="flex flex-1 justify-between sm:hidden"><button class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer">Anterior</button> <button class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer">Siguiente</button></div> <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"><div><p class="text-sm text-gray-700">Página <span class="font-medium"> </span> de <span class="font-medium"> </span></p></div> <div><nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination"><button class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer"><span class="sr-only">Anterior</span> <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd"></path></svg></button> <button class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer"><span class="sr-only">Siguiente</span> <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010-1.08l-4.5-4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd"></path></svg></button></nav></div></div></div>',1),da=h('<p class="px-6 py-10 text-center text-gray-500">No hay gastos registrados. ¡Añade uno para empezar!</p>'),ca=h('<!> <div class="container mx-auto p-4 sm:p-6 lg:p-8"><div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"><div><h2 class="text-xl font-bold text-gray-800 mb-4">Resumen Anual</h2> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><!></div></div> <div><h2 class="text-xl font-bold text-gray-800 mb-4">Resumen Mensual</h2> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><!></div></div></div> <h2 class="text-xl font-bold text-gray-800 mb-4">Lista de Gastos</h2> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><!></div></div>',1);function xa(x,b){Xt(b,!1);const[D,R]=je(),c=()=>Ut(Et,"$currentPage",D),i=()=>Ut(qt,"$paginatedExpenses",D);let p=B(null),k=B(""),z=B(""),C=B(""),A=B(""),y=B(!1),E=null;const M=["Ocio","Comida/Bebida","Hogar","Gastos Personales","Otros"];let T=B({}),$=B({});const I=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];function V(e){const o=new Date(e),w=o.getFullYear(),d=("0"+(o.getMonth()+1)).slice(-2),l=("0"+o.getDate()).slice(-2);return`${w}-${d}-${l}`}const u=e=>{E=e,f(y,!0)},L=async()=>{if(f(y,!1),E)try{await qe(Kt(Zt,"gastos",E)),ct("Gasto eliminado correctamente","success")}catch(e){console.error("Error removing document: ",e),ct("Error al eliminar el gasto","error")}finally{E=null}},W=()=>{f(y,!1),E=null},te=e=>{f(p,e),f(k,e.descripcion),f(z,e.cantidad),f(C,V(e.fecha.toDate?e.fecha.toDate():e.fecha)),f(A,e.categoria||"Otros")},ee=()=>{f(p,null)},ae=async()=>{try{const e=Kt(Zt,"gastos",a(p).id);await Je(e,{descripcion:a(k),cantidad:parseFloat(a(z)),fecha:He.fromDate(new Date(a(C))),categoria:a(A)}),f(p,null),ct("Gasto actualizado correctamente","success")}catch(e){console.error("Error updating document: ",e),ct("Error al actualizar el gasto","error")}},re=e=>{const o={},w={};e.forEach(d=>{const l=d.fecha.toDate?d.fecha.toDate():new Date(d.fecha),n=l.getUTCFullYear(),m=l.getUTCMonth(),_=`${n}-${m}`;o[_]||(o[_]={year:n,month:m,total:0}),o[_].total+=d.cantidad,w[n]||(w[n]={year:n,total:0}),w[n].total+=d.cantidad}),f(T,Object.entries(o).sort(([d],[l])=>l.localeCompare(d)).map(([d,l])=>({...l,monthName:I[l.month]}))),f($,Object.entries(w).sort(([d],[l])=>parseInt(l)-parseInt(d)).map(([d,l])=>l))};function se(e){return(e.toDate?e.toDate():e).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"UTC"})}qt.subscribe(e=>{e&&e.data&&re(e.data)}),Te(()=>(c(),i(),Et),()=>{c()>i().totalPages&&Et.set(i().totalPages||1)}),Fe(),Vt();var Pt=ca(),Ct=tt(Pt);Qe(Ct,{message:"¿Estás seguro de que quieres eliminar este gasto? Esta acción no se puede deshacer.",get isOpen(){return a(y)},set isOpen(e){f(y,e)},$$events:{confirm:L,cancel:W},$$legacy:!0});var St=s(Ct,2),gt=r(St),ft=r(gt),Ot=s(r(ft),2),oe=r(Ot);{var ie=e=>{var o=We(),w=r(o),d=s(r(w));ut(d,5,()=>a($),l=>l.year,(l,n)=>{var m=Ve(),_=r(m),et=r(_,!0);t(_);var Y=s(_),F=r(Y);t(Y),t(m),G(j=>{P(et,(a(n),v(()=>a(n).year))),P(F,`$${j??""}`)},[()=>(a(n),v(()=>a(n).total.toFixed(2)))]),g(l,m)}),t(d),t(w),t(o),g(e,o)},ne=e=>{var o=Xe();g(e,o)};Q(oe,e=>{a($),v(()=>a($).length>0)?e(ie):e(ne,!1)})}t(Ot),t(ft);var kt=s(ft,2),At=s(r(kt),2),le=r(At);{var de=e=>{var o=ea(),w=r(o),d=s(r(w));ut(d,5,()=>a(T),l=>`${l.year}-${l.month}`,(l,n)=>{var m=ta(),_=r(m),et=r(_);t(_);var Y=s(_),F=r(Y);t(Y),t(m),G(j=>{P(et,`${a(n),v(()=>a(n).monthName)??""} ${a(n),v(()=>a(n).year)??""}`),P(F,`$${j??""}`)},[()=>(a(n),v(()=>a(n).total.toFixed(2)))]),g(l,m)}),t(d),t(w),t(o),g(e,o)},ce=e=>{var o=aa();g(e,o)};Q(le,e=>{a(T),v(()=>a(T).length>0)?e(de):e(ce,!1)})}t(At),t(kt),t(gt);var Mt=s(gt,4),ue=r(Mt);{var ve=e=>{var o=ra();g(e,o)},ge=e=>{var o=vt(),w=tt(o);{var d=n=>{var m=sa(),_=r(m,!0);t(m),G(()=>P(_,(i(),v(()=>i().error)))),g(n,m)},l=n=>{var m=vt(),_=tt(m);{var et=F=>{var j=la(),pt=tt(j),$t=r(pt),Nt=s(r($t));ut(Nt,5,()=>(i(),v(()=>i().paginatedData)),U=>U.id,(U,S)=>{var Gt=vt(),me=tt(Gt);{var be=X=>{var q=ia(),J=r(q),nt=r(J);wt(nt),t(J);var H=s(J),at=r(H);G(()=>{a(A),Re(()=>{})}),ut(at,5,()=>M,Ge,(N,ot)=>{var it=oa(),ye=r(it,!0);t(it);var Yt={};G(()=>{P(ye,a(ot)),Yt!==(Yt=a(ot))&&(it.value=(it.__value=a(ot))??"")}),g(N,it)}),t(at),t(H);var K=s(H),lt=r(K);wt(lt),t(K);var Z=s(K),dt=r(Z);wt(dt),t(Z);var rt=s(Z),st=r(rt),ht=s(st,2);t(rt),t(q),Dt(nt,()=>a(k),N=>f(k,N)),Ye(at,()=>a(A),N=>f(A,N)),Dt(lt,()=>a(z),N=>f(z,N)),Dt(dt,()=>a(C),N=>f(C,N)),O("click",st,ae),O("click",ht,ee),g(X,q)},xe=X=>{var q=na(),J=r(q),nt=r(J,!0);t(J);var H=s(J),at=r(H,!0);t(H);var K=s(H),lt=r(K);t(K);var Z=s(K),dt=r(Z,!0);t(Z);var rt=s(Z),st=r(rt),ht=s(st,2);t(rt),t(q),G((N,ot)=>{P(nt,(a(S),v(()=>a(S).descripcion))),P(at,(a(S),v(()=>a(S).categoria||"N/A"))),P(lt,`$${N??""}`),P(dt,ot)},[()=>(a(S),v(()=>a(S).cantidad.toFixed(2))),()=>(a(S),v(()=>se(a(S).fecha)))]),O("click",st,()=>te(a(S))),O("click",ht,()=>u(a(S).id)),g(X,q)};Q(me,X=>{a(p),a(S),v(()=>a(p)&&a(p).id===a(S).id)?X(be):X(xe,!1)})}g(U,Gt)}),t(Nt),t($t),t(pt);var Tt=s(pt,2),mt=r(Tt),bt=r(mt),Ft=s(bt,2);t(mt);var Rt=s(mt,2),xt=r(Rt),zt=r(xt),yt=s(r(zt)),fe=r(yt,!0);t(yt);var It=s(yt,2),pe=r(It,!0);t(It),t(zt),t(xt);var Lt=s(xt,2),jt=r(Lt),_t=r(jt),Bt=s(_t,2);t(jt),t(Lt),t(Rt),t(Tt),G(()=>{bt.disabled=c()===1,Ft.disabled=(c(),i(),v(()=>c()===i().totalPages)),P(fe,c()),P(pe,(i(),v(()=>i().totalPages))),_t.disabled=c()===1,Bt.disabled=(c(),i(),v(()=>c()===i().totalPages))}),O("click",bt,function(...U){Jt?.apply(this,U)}),O("click",Ft,()=>Ht(i().totalPages)),O("click",_t,function(...U){Jt?.apply(this,U)}),O("click",Bt,()=>Ht(i().totalPages)),g(F,j)},Y=F=>{var j=da();g(F,j)};Q(_,F=>{i(),v(()=>i().paginatedData.length>0)?F(et):F(Y,!1)},!0)}g(n,m)};Q(w,n=>{i(),v(()=>i().error)?n(d):n(l,!1)},!0)}g(e,o)};Q(ue,e=>{i(),v(()=>i().loading)?e(ve):e(ge,!1)})}t(Mt),t(St),g(x,Pt),Wt(),R()}export{xa as default};
