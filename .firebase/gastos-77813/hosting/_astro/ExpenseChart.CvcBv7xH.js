import{a as U,s as I,b as J,i as W}from"./store.CUww-eZX.js";import{m as X,e as q,f as B,o as Z}from"./expenseStore.B72t6hGa.js";import{j as tt,k as K,a as k,f as A,c as s,s as i,r as a,t as L,u as et,g as l,d as C,p as at,b as st,m as V}from"./template.CsvUa5oO.js";import{s as z,e as O}from"./render.D2y0TSMt.js";import{C as N,r as ot,b as nt}from"./chart.zX7s5j_d.js";import{e as rt,i as it,s as lt}from"./event-modifiers.DGqNQqsZ.js";import{p as ct,b as dt}from"./props.BKxzdaK1.js";import"./firebase.C6L9Uwjb.js";N.register(...ot);var ut=A('<li class="border-b last:border-b-0 py-2 flex justify-between"><span> </span> <span class="font-semibold"> </span></li>'),pt=A('<div class="fixed inset-0 bg-gray-100/80  z-50 flex justify-center items-center"><div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md"><h2 class="text-lg font-bold mb-4">Historial de Gastos Mensuales</h2> <div class="overflow-y-auto max-h-96"><ul></ul></div> <button class="mt-4 px-6 py-2 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-300 cursor-pointer">Cerrar</button></div></div>');function ft(E,_){const[j,T]=I(),F=()=>J(X,"$monthlyExpenses",j);let c=ct(_,"isOpen",12,!1);function o(){c(!1)}var h=tt(),m=K(h);{var w=d=>{var u=pt(),p=s(u),f=i(s(p),2),v=s(f);rt(v,5,F,it,(g,x)=>{let y=()=>l(x).month,H=()=>l(x).year,M=()=>l(x).total;var t=ut(),e=s(t),Y=s(e);a(e);var $=i(e,2),D=s($);a($),a(t),L(R=>{z(Y,`${y()??""} ${H()??""}`),z(D,`$${R??""}`)},[()=>(M(),et(()=>M().toFixed(2)))]),k(g,t)}),a(v),a(f);var b=i(f,2);a(p),a(u),O("click",b,o),O("click",p,lt(function(g){dt.call(this,_,g)})),O("click",u,o),k(d,u)};U(m,d=>{c()&&d(w)})}k(E,h),T()}var gt=A('<!> <div class="bg-white p-4 rounded-lg shadow-md flex flex-col h-full"><h2 class="text-xl font-bold mb-2">Resumen del Mes</h2> <p class="text-lg">Total gastado este mes: <span class="font-semibold"> </span></p> <div class="mt-4 h-64 flex-grow"><canvas></canvas></div> <button class="mt-4 px-6 py-3 bg-indigo-600 text-white font-semibold rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-300 cursor-pointer">Ver historial de meses</button></div>',1);function Mt(E,_){st(_,!1);const[j,T]=I(),F=()=>J(q,"$expenses",j);let c=V(),o,h=V(0),m=V(!1);q.subscribe(t=>{if(t.loading||!t.data.length)return;const e=w(t.data);C(h,e.currentMonthTotal),o?u(e.chartData):d(e.chartData)});function w(t){const e=new Date,Y=e.getMonth(),$=e.getFullYear(),D=t.filter(n=>{const r=new Date(n.fecha);return r.getMonth()===Y&&r.getFullYear()===$}),R=D.reduce((n,r)=>n+r.monto,0),G=D.reduce((n,r)=>(n[r.categoria]=(n[r.categoria]||0)+r.monto,n),{}),P=Object.keys(G),Q=Object.values(G),S=P.map(n=>B[n]||B.Default);return{currentMonthTotal:R,chartData:{labels:P,datasets:[{data:Q,backgroundColor:S}]}}}function d(t){l(c)&&(o=new N(l(c),{type:"doughnut",data:t,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}}))}function u(t){o&&(o.data=t,o.update())}Z(()=>{const t=F();if(!t.loading&&t.data.length){const e=w(t.data);o||d(e.chartData)}}),W();var p=gt(),f=K(p);ft(f,{get isOpen(){return l(m)},set isOpen(t){C(m,t)},$$legacy:!0});var v=i(f,2),b=i(s(v),2),g=i(s(b)),x=s(g);a(g),a(b);var y=i(b,2),H=s(y);nt(H,t=>C(c,t),()=>l(c)),a(y);var M=i(y,2);a(v),L(t=>z(x,`$${t??""}`),[()=>l(h).toFixed(2)]),O("click",M,()=>C(m,!0)),k(E,p),at(),T()}export{Mt as default};
