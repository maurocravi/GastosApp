import{i as na}from"./index.DVytYfkC.js";import{f as u,a as c,p as da,b as la,s as g,m as A,c as a,d as s,g as r,r as t,t as F,e as lt,h as K,i as ca}from"./template.BdtgHAX2.js";import{s as m,e as h}from"./render.CEeqJg5k.js";import{i as M,s as pa,a as At,b as Z}from"./Notification.OD5x1MGB.js";import{e as Q,r as ct,i as va,b as pt,a as ua}from"./input.CmnFHdDa.js";import{p as Ft,a as Nt,n as zt,d as Mt,b as St,u as ga,T as ma,c as xa,e as ba}from"./expenseStore.M8Kam9Dl.js";var ya=u('<tr class="bg-white "><td class="px-6 py-4 font-medium text-gray-900"> </td><td class="px-6 py-4 text-gray-500"> </td></tr>'),fa=u('<div class="overflow-x-auto"><table class="min-w-full text-sm text-left text-gray-700"><thead class="bg-gray-50 text-xs text-gray-500 uppercase"><tr><th scope="col" class="px-6 py-3">Año</th><th scope="col" class="px-6 py-3">Total</th></tr></thead><tbody></tbody></table></div>'),ha=u('<p class="p-6 text-center text-gray-500">No hay datos para el resumen anual.</p>'),_a=u('<tr class="bg-white"><td class="px-6 py-4 font-medium text-gray-900"> </td><td class="px-6 py-4 text-gray-500"> </td></tr>'),wa=u('<div class="overflow-x-auto max-h-80"><table class="min-w-full text-sm text-left text-gray-700"><thead class="bg-gray-50 text-xs text-gray-500 uppercase sticky top-0"><tr><th scope="col" class="px-6 py-3">Mes</th><th scope="col" class="px-6 py-3">Total</th></tr></thead><tbody class="overflow-y-auto"></tbody></table></div>'),Ea=u('<p class="p-6 text-center text-gray-500">No hay datos para el resumen mensual.</p>'),Da=u('<p class="px-6 py-10 text-center text-gray-500">Cargando gastos...</p>'),Pa=u('<p class="px-6 py-10 text-center text-red-500"> </p>'),ka=u("<option> </option>"),Ca=u('<tr class="bg-blue-50 border-b"><td class="px-6 py-4"><input type="text" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"/></td><td class="px-6 py-4"><select class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"></select></td><td class="px-6 py-4"><input type="number" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"/></td><td class="px-6 py-4"><input type="date" class="w-full bg-white border border-gray-300 rounded-md shadow-sm py-1 px-2 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"/></td><td class="px-6 py-4 text-right"><button class="font-medium text-green-600 hover:text-green-800 mr-4 transition-all duration-300 ease-in-out cursor-pointer">Guardar</button> <button class="font-medium text-gray-600 hover:text-gray-800 transition-all duration-300 ease-in-out cursor-pointer">Cancelar</button></td></tr>'),$a=u('<tr class="bg-white border-b border-gray-100 hover:bg-gray-50"><td class="px-6 py-4 font-medium text-gray-900"> </td><td class="px-6 py-4 text-gray-500"> </td><td class="px-6 py-4 text-gray-500"> </td><td class="px-6 py-4 text-gray-500"> </td><td class="px-6 py-4 text-right"><button class="font-medium text-indigo-600 hover:text-indigo-900 mr-4 transition-all duration-300 ease-in-out cursor-pointer">Editar</button> <button class="font-medium text-red-600 hover:text-red-900 transition-all duration-300 ease-in-out cursor-pointer">Eliminar</button></td></tr>'),Aa=u('<div class="overflow-x-auto"><table class="min-w-full text-sm text-left text-gray-700"><thead class="bg-gray-50 text-xs text-gray-500 uppercase"><tr><th scope="col" class="px-6 py-3">Descripción</th><th scope="col" class="px-6 py-3">Categoría</th><th scope="col" class="px-6 py-3">Cantidad</th><th scope="col" class="px-6 py-3">Fecha</th><th scope="col" class="px-6 py-3 text-right">Acciones</th></tr></thead><tbody></tbody></table></div> <div class="flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6"><div class="flex flex-1 justify-between sm:hidden"><button class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer">Anterior</button> <button class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer">Siguiente</button></div> <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between"><div><p class="text-sm text-gray-700">Página <span class="font-medium"> </span> de <span class="font-medium"> </span></p></div> <div><nav class="isolate inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination"><button class="relative inline-flex items-center rounded-l-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer"><span class="sr-only">Anterior</span> <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd"></path></svg></button> <button class="relative inline-flex items-center rounded-r-md px-2 py-2 text-gray-400 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0 disabled:opacity-50 transition-colors duration-300 ease-in-out cursor-pointer"><span class="sr-only">Siguiente</span> <svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd"></path></svg></button></nav></div></div></div>',1),Fa=u('<p class="px-6 py-10 text-center text-gray-500">No hay gastos registrados. ¡Añade uno para empezar!</p>'),Na=u('<div class="container mx-auto p-4 sm:p-6 lg:p-8"><div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8"><div><h2 class="text-xl font-bold text-gray-800 mb-4">Resumen Anual</h2> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><!></div></div> <div><h2 class="text-xl font-bold text-gray-800 mb-4">Resumen Mensual</h2> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><!></div></div></div> <h2 class="text-xl font-bold text-gray-800 mb-4">Lista de Gastos</h2> <div class="bg-white shadow-lg rounded-lg overflow-hidden"><!></div></div>');function Ga(Tt,Ot){la(Ot,!1);const[vt,jt]=pa(),b=()=>At(Ft,"$paginatedExpenses",vt),S=()=>At(ba,"$currentPage",vt);let N=A(null),R=A(""),U=A(""),Y=A(""),T=A("");const Gt=["Ocio","Comida/Bebida","Hogar","Gastos Personales","Otros"];let V=A({}),W=A({});const Lt=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];function Bt(e){const o=new Date(e),v=o.getFullYear(),d=("0"+(o.getMonth()+1)).slice(-2),i=("0"+o.getDate()).slice(-2);return`${v}-${d}-${i}`}const It=async e=>{if(confirm("¿Estás seguro de que quieres eliminar este gasto?"))try{await xa(Mt(St,"gastos",e)),Z("Gasto eliminado correctamente","success")}catch(o){console.error("Error removing document: ",o),Z("Error al eliminar el gasto","error")}},Rt=e=>{g(N,e),g(R,e.descripcion),g(U,e.cantidad),g(Y,Bt(e.fecha)),g(T,e.categoria||"Otros")},Ut=()=>{g(N,null)},Yt=async()=>{try{const e=Mt(St,"gastos",r(N).id);await ga(e,{descripcion:r(R),cantidad:parseFloat(r(U)),fecha:ma.fromDate(new Date(r(Y))),categoria:r(T)}),g(N,null),Z("Gasto actualizado correctamente","success")}catch(e){console.error("Error updating document: ",e),Z("Error al actualizar el gasto","error")}},qt=e=>{const o={},v={};e.forEach(d=>{const i=new Date(d.fecha),n=i.getUTCFullYear(),l=i.getUTCMonth(),p=`${n}-${l}`;o[p]||(o[p]={year:n,month:l,total:0}),o[p].total+=d.cantidad,v[n]||(v[n]={year:n,total:0}),v[n].total+=d.cantidad}),g(V,Object.entries(o).sort(([d],[i])=>i.localeCompare(d)).map(([d,i])=>({...i,monthName:Lt[i.month]}))),g(W,Object.entries(v).sort(([d],[i])=>parseInt(i)-parseInt(d)).map(([d,i])=>i))};Ft.subscribe(e=>{e&&e.data&&qt(e.data)}),na();var X=Na(),tt=a(X),at=a(tt),ut=s(a(at),2),Jt=a(ut);{var Ht=e=>{var o=fa(),v=a(o),d=s(a(v));Q(d,5,()=>r(W),i=>i.year,(i,n)=>{var l=ya(),p=a(l),O=a(p,!0);t(p);var _=s(p),y=a(_);t(_),t(l),F(f=>{m(O,r(n).year),m(y,`$${f??""}`)},[()=>r(n).total.toFixed(2)]),c(i,l)}),t(d),t(v),t(o),c(e,o)},Kt=e=>{var o=ha();c(e,o)};M(Jt,e=>{r(W).length>0?e(Ht):e(Kt,!1)})}t(ut),t(at);var gt=s(at,2),mt=s(a(gt),2),Zt=a(mt);{var Qt=e=>{var o=wa(),v=a(o),d=s(a(v));Q(d,5,()=>r(V),i=>`${i.year}-${i.month}`,(i,n)=>{var l=_a(),p=a(l),O=a(p);t(p);var _=s(p),y=a(_);t(_),t(l),F(f=>{m(O,`${r(n).monthName??""} ${r(n).year??""}`),m(y,`$${f??""}`)},[()=>r(n).total.toFixed(2)]),c(i,l)}),t(d),t(v),t(o),c(e,o)},Vt=e=>{var o=Ea();c(e,o)};M(Zt,e=>{r(V).length>0?e(Qt):e(Vt,!1)})}t(mt),t(gt),t(tt);var xt=s(tt,4),Wt=a(xt);{var Xt=e=>{var o=Da();c(e,o)},ta=e=>{var o=lt(),v=K(o);{var d=n=>{var l=Pa(),p=a(l,!0);t(l),F(()=>m(p,b().error)),c(n,l)},i=n=>{var l=lt(),p=K(l);{var O=y=>{var f=Aa(),et=K(f),bt=a(et),yt=s(a(bt));Q(yt,5,()=>b().paginatedData,w=>w.id,(w,E)=>{var Ct=lt(),ra=K(Ct);{var oa=z=>{var D=Ca(),P=a(D),q=a(P);ct(q),t(P);var k=s(P),j=a(k);F(()=>{r(T),ca(()=>{})}),Q(j,5,()=>Gt,va,(x,B)=>{var I=ka(),ia=a(I,!0);t(I);var $t={};F(()=>{m(ia,r(B)),$t!==($t=r(B))&&(I.value=(I.__value=r(B))??"")}),c(x,I)}),t(j),t(k);var C=s(k),J=a(C);ct(J),t(C);var $=s(C),H=a($);ct(H),t($);var G=s($),L=a(G),dt=s(L,2);t(G),t(D),pt(q,()=>r(R),x=>g(R,x)),ua(j,()=>r(T),x=>g(T,x)),pt(J,()=>r(U),x=>g(U,x)),pt(H,()=>r(Y),x=>g(Y,x)),h("click",L,Yt),h("click",dt,Ut),c(z,D)},sa=z=>{var D=$a(),P=a(D),q=a(P,!0);t(P);var k=s(P),j=a(k,!0);t(k);var C=s(k),J=a(C);t(C);var $=s(C),H=a($,!0);t($);var G=s($),L=a(G),dt=s(L,2);t(G),t(D),F((x,B)=>{m(q,r(E).descripcion),m(j,r(E).categoria||"N/A"),m(J,`$${x??""}`),m(H,B)},[()=>r(E).cantidad.toFixed(2),()=>r(E).fecha.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",timeZone:"UTC"})]),h("click",L,()=>Rt(r(E))),h("click",dt,()=>It(r(E).id)),c(z,D)};M(ra,z=>{r(N)&&r(N).id===r(E).id?z(oa):z(sa,!1)})}c(w,Ct)}),t(yt),t(bt),t(et);var ft=s(et,2),rt=a(ft),ot=a(rt),ht=s(ot,2);t(rt);var _t=s(rt,2),st=a(_t),wt=a(st),it=s(a(wt)),aa=a(it,!0);t(it);var Et=s(it,2),ea=a(Et,!0);t(Et),t(wt),t(st);var Dt=s(st,2),Pt=a(Dt),nt=a(Pt),kt=s(nt,2);t(Pt),t(Dt),t(_t),t(ft),F(()=>{ot.disabled=S()===1,ht.disabled=S()===b().totalPages,m(aa,S()),m(ea,b().totalPages),nt.disabled=S()===1,kt.disabled=S()===b().totalPages}),h("click",ot,function(...w){Nt?.apply(this,w)}),h("click",ht,()=>zt(b().totalPages)),h("click",nt,function(...w){Nt?.apply(this,w)}),h("click",kt,()=>zt(b().totalPages)),c(y,f)},_=y=>{var f=Fa();c(y,f)};M(p,y=>{b().paginatedData.length>0?y(O):y(_,!1)},!0)}c(n,l)};M(v,n=>{b().error?n(d):n(i,!1)},!0)}c(e,o)};M(Wt,e=>{b().loading?e(Xt):e(ta,!1)})}t(xt),t(X),c(Tt,X),da(),jt()}export{Ga as default};
